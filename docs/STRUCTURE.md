# Repository Structure

The repository is now organized so that production code, tooling, documentation, and captured artifacts each have a dedicated home. Use this guide as the source of truth when adding new files.

| Path | Purpose |
| --- | --- |
| `src/` | Application sources (bootstrap flow, USB protocol, DDR builder, firmware handlers). Keep files grouped by subsystem (`usb/`, `ddr/`, `firmware/`). |
| `include/` | Public headers shared across modules. Prefer matching the subtree layout from `src/`. |
| `scripts/analysis/` | One-off helpers used during reverse engineering (e.g., `extract_ddr_from_pcap.py`, handshake decoders). Short utilities belong here. |
| `scripts/capture/` | Shell utilities that orchestrate usbmon/tcpdump captures. Anything that needs `sudo` access or coordinates multiple terminals belongs here. |
| `tools/` | The full USB capture + analysis framework (long-running scripts, comparison pipelines, generators). |
| `tests/unit/` | Self-contained C tests grouped by domain (`ddr/`, `firmware/`, `usb/`). New unit tests should live next to their subsystem. |
| `tests/integration/` | End-to-end or workflow tests that exercise multiple subsystems together. |
| `tests/legacy/` | Historical experiments retained for reference. Prefer migrating working tests into `tests/unit` or `tests/integration`. |
| `docs/` | Architecture notes and integration guides. Use `docs/reports/` for deep-dives, timelines, or investigative writeups. |
| `references/vendor/` | Source-of-truth artifacts captured from vendor tools. Subfolders hold firmware blobs, DDR dumps, captures, and logs. |
| `references/ddr/` | DDR artifacts generated by thingino-cloner for cross-checking. |
| `third_party/` | Vendored dependencies (libusb, reference binaries) kept untouched. |

## Adding Documentation

- Use `docs/reports/` for investigative writeups, capture summaries, and workflow retrospectives.
- Add lightweight HOWTOs or architectural notes directly under `docs/`.
- Reference files with their repo-relative paths so links remain valid after relocation.

## Tests & Build Outputs

- Place new subsystem tests under `tests/unit/<area>/` and wire them up in `CMakeLists.txt`.
- Integration scenarios that boot hardware or process real captures belong in `tests/integration/`.
- Generated binaries, `.o` files, or ad-hoc test executables should never be committed—`build/` and `*.o` are already ignored.

## Reference Data

- DDR/firmware/capture artifacts taken from vendor tools live under `references/vendor/` with further subdivision:
  - `captures/` → Raw `.pcap` files and extracted bulk dumps.
  - `ddr/` → Known-good DDR binaries and hex dumps.
  - `firmware/` → Vendor firmware images used for diffing.
  - `logs/` → Canonical log outputs that future investigations may reference.
- Project-authored DDR artifacts should go to `references/ddr/`.
- Always prefer storing derived data in `references/` rather than scattering binaries at the repo root.
